@using ILK_Protokoll.util
@using ILK_Protokoll.Models
@model Topic

@{
	ViewBag.Title = "Details (" + Model.Title + ")";
	var history = (ICollection<TopicHistory>)ViewBag.TopicHistory;
}

<h3>@ViewBag.Title</h3>
<hr />

<div class="row">
	<div class="col-md-12">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">Stammdaten</h3>
			</div>
			<div class="panel-body">
				<dl class="dl-horizontal">
					<dt>@Html.DisplayNameFor(model => model.ID)</dt>
					<dd>@Html.DisplayFor(model => model.ID)</dd>

					<dt>@Html.DisplayNameFor(model => model.Title)</dt>
					<dd>@Html.DisplayFor(model => model.Title)</dd>

					<dt>@Html.DisplayNameFor(model => model.SessionTypeID)</dt>
					<dd>@Html.DisplayFor(model => model.SessionType.Name)</dd>

					@if (Model.TargetSessionTypeID != null)
					{
						<dt>@Html.DisplayNameFor(model => model.TargetSessionTypeID)</dt>
						<dd>@Html.DisplayFor(model => model.TargetSessionType.Name)</dd>
					}

					<dt>@Html.DisplayNameFor(model => model.OwnerID)</dt>
					<dd>@Html.DisplayFor(model => model.Owner.Name)</dd>

					<dt>@Html.DisplayNameFor(model => model.Priority)</dt>
					<dd>@Model.Priority.DisplayName()</dd>

					<dt>@Html.DisplayNameFor(model => model.Created)</dt>
					<dd>@Html.DisplayFor(model => model.Created)</dd>

					@if (history.Count > 0)
					{
						<dt>@Html.DisplayNameFor(model => model.ValidFrom)</dt>
						<dd>@Html.DisplayFor(model => model.ValidFrom) (Insgesamt @history.Count mal geändert)</dd>
					}
				</dl>
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-md-6">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">@Html.DisplayNameFor(model => model.Description)</h3>
			</div>
			<div class="panel-body">
				@Html.DisplayFor(model => model.Description)
			</div>
		</div>
	</div>

	<div class="col-md-6">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">@Html.DisplayNameFor(model => model.Proposal)</h3>
			</div>
			<div class="panel-body">
				@Html.DisplayFor(model => model.Proposal)
			</div>
		</div>
	</div>
</div>

<div class="panel panel-primary" style="background-color: #DDD">
	<div class="panel-heading">
		<h3 class="panel-title">@Html.DisplayNameFor(model => model.Votes)</h3>
	</div>
	<div class="panel-body" id="auditorlist_@Model.ID">
		@Html.Action("_List", "Votes", new { t = Model, linkAllAuditors = true })
	</div>
</div>

<div class="panel panel-primary" style="background-color: #B7BCD6">
	<div class="panel-heading">
		<h3 class="panel-title">@Html.DisplayNameFor(model => model.Comments)</h3>
	</div>
	<div class="panel-body" id="comments_@Model.ID">
		@Html.Action("_List", "Comments", Model)
	</div>
</div>


<div class="row">
	<div class="col-md-12">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">@Html.DisplayNameFor(model => model.Attachments)</h3>
			</div>

			@if (Model.Attachments.Count == 0)
			{
				<div class="panel-body" id="attachments_@Model.ID">Keine Dateianhänge vorhanden.</div>
			}
			else
			{
				<table class="table table-hover table-striped">
					<thead>
						<tr>
							<th>&nbsp;</th>
							<th>Name</th>
							<th>Besitzer</th>
							<th>Hochgeladen am</th>
							<th>Aktionen</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var file in Model.Attachments)
						{
							<tr>
								<td><img src="~/img/fileicons/xlsx.png" /></td>
								<td>@file.Name</td>
								<td>@file.Uploader.Name</td>
								<td>@file.Created.ToString("g")</td>
								<td class="actions">
									<a href=""><span class="glyphicon glyphicon-edit" title="Name bearbeiten"></span></a>
									<a href=""><span class="glyphicon glyphicon-remove" title="Datei löschen"></span></a>
								</td>
							</tr>
							<tr>
								<td><img src="~/img/fileicons/xlsx.png" /></td>
								<td>@file.Name</td>
								<td>@file.Uploader.Name</td>
								<td>@file.Created.ToString("g")</td>
								<td class="actions">
									<a href=""><span class="glyphicon glyphicon-edit" title="Name bearbeiten"></span></a>
									<a href=""><span class="glyphicon glyphicon-remove" title="Datei löschen"></span></a>
								</td>
							</tr>
							<tr>
								<td><img src="~/img/fileicons/xlsx.png" /></td>
								<td>@file.Name</td>
								<td>@file.Uploader.Name</td>
								<td>@file.Created.ToString("g")</td>
								<td class="actions">
									<a href=""><span class="glyphicon glyphicon-edit" title="Name bearbeiten"></span></a>
									<a href=""><span class="glyphicon glyphicon-remove" title="Datei löschen"></span></a>
								</td>
							</tr>
						}
					</tbody>

				</table>
			}
			<div class="panel-footer" id="">Formular</div>
		</div>
	</div>
</div>

<p>
	@Html.ActionLink("Edit", "Edit", new { id = Model.ID }) |
	@Html.ActionLink("Back to List", "Index")
</p>
